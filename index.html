<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="jscolor.js"></script>
	</head>
	<body>
		<center>
			<div id="canvasdiv" style="margin: 5px; height: 400px; width: 100%;">
				<canvas id="myCanvas">Your browser does not support the HTML5 canvas tag.</canvas>
			</div>
		<form>
		  Digite o nome aqui:<br>
		  <input type="text" id="input" name="input" placeholder="nome aqui">
		</form>
			Color: <input class="jscolor" onchange="update(this.jscolor)" value="cc66ff"><br><br>
		  <button onclick="submitButton()">Gerar</button>

	</body>
	<script type="text/javascript">

	var point = class point {
  		constructor(x, y) { 
		    this.x = x;
		    this.y = y;
  		}
	};

	var pointLetter = class pointLetter {
  		constructor(letterLabel, dotPoint, labelPoint) { 
		    this.letterLabel = letterLabel;
		    this.dotPoint = dotPoint;
		    this.labelPoint = labelPoint;
  		}

  		draw() {
			    ctx.beginPath();
			    ctx.arc(this.dotPoint.x, this.dotPoint.y, point_size, 0, 2 * Math.PI);
			    ctx.fill();

			    ctx.font = font_size;
			    ctx.fillText(this.letterLabel,this.labelPoint.x,this.labelPoint.y);
  		}


	};
			//Define Variables
			var alphabet = "JKLMNOPQRSTUVWXYZ1234567890ABCDEFGHI";
			var defaultLetterLabelDistance = 0.3;
			var pointLetters = [];
			var radius = 85;
			var point_size = 4;
			var font_size = "20px";
			var strokeColor = "000000";


			var $canvasDiv = $('#canvasdiv');

			var c = document.getElementById("myCanvas");
			c.height = $canvasDiv.innerHeight();
			c.width = $canvasDiv.innerWidth();


			var center_x = c.width/2;
			var center_y = c.height/2;

			var ctx = c.getContext("2d");


			function drawCircle(){
			    ctx.beginPath();
			    ctx.arc(center_x, center_y, radius, 0, 2 * Math.PI);
			    ctx.stroke();
			}

			function pointFor(angle,distance){
			    var x = center_x + radius * Math.cos(+angle*Math.PI/180) * distance;
			    var y = center_y + radius * Math.sin(+angle*Math.PI/180) * distance;
				return new point(x,y);
			}

			function drawDotAt(point) {
			    ctx.beginPath();
			    ctx.arc(point.x, point.y, point_size, 0, 2 * Math.PI);
			    ctx.fill();
			}

			function drawLetterAt(angle,distance,label){
			    var point = pointFor(angle, distance);
			    var letterPoint = pointFor(angle, distance+0.3);

			    drawDotAt(point);

			    ctx.font = font_size;
			    ctx.fillText(label,letterPoint.x,letterPoint.y);
			}

			function drawAlphabet() {
				for (var i = 0; i < alphabet.length; i++) {
					var aLetter = new pointLetter(
						alphabet.charAt(i),
						pointFor(360/alphabet.length*i,1),
						pointFor(360/alphabet.length*i,1+defaultLetterLabelDistance),
					);
					pointLetters.push(aLetter);
					aLetter.draw();
				};
			}

			function drawLine(from, to){
				ctx.beginPath();
				ctx.moveTo(from.dotPoint.x,from.dotPoint.y);
				ctx.lineWidth=5;
				ctx.strokeStyle = "#"+strokeColor;
				ctx.lineTo(to.dotPoint.x,to.dotPoint.y);
				ctx.stroke();
			}

			function refresh(){
				ctx.clearRect(0, 0, c.width, c.height);
				drawAlphabet();
				var input = document.querySelector('input');
				generateDraw(input.value.toUpperCase());
			}

			function submitButton(){
				refresh();
				 window.location = c.toDataURL("image/png");
			}

			function generateDraw(string){
				var last = -1
				for (var i = 0; i < string.length; i++) {
					var res = string.substring(i, i+1);
					var index = alphabet.indexOf(res);
					if (index>0) {
						if (last>=0) {//do the magic
							drawLine(pointLetters[last],pointLetters[index]);
						};
						last = index;
					};
				};

			}

			//Execution
			// drawCircle();
			drawAlphabet();

		</script>

		<script>
			var input = document.querySelector('input');

			input.addEventListener('input', function()
			{
				var inputValue = input.value
			    console.log('input changed to: ', inputValue);
			    refresh();
			});

			function update(jscolor) {
		    // 'jscolor' instance can be used as a string
			     strokeColor = jscolor;
			     refresh();
			}


		</script>




</html>

<!-- TODO
	TAMANHO DO CANVAS DINAMICO
	RETORNAR O PONTO XY DE UM ANGULO - DONE
	MONTAR O ARRAY DO ALFABETO - DONE
	PREENCHER O CIRCULO DE UMA COR
	DESENHAR LINHAS DE UM PONTO A OUTRO - DONE
	ADICIONAR INPUT DE TEXTO - DONE
	PARA CADA LETRA DO INPUT DESENHAR A LINHA - DONE
	EXPORTAR CANVAS